import"./main-uRKXSqnm.js";const u="https://corsproxy.io/?url=",b="janusrvk",$="74f09a6e65ddc20949e95f2a014cd3ee";async function v(){const n=document.getElementById("lastfm-content");try{const r=(await(await fetch(`https://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&user=${b}&api_key=${$}&format=json&limit=5`)).json()).recenttracks?.track?.slice(0,5);if(!r||r.length===0){n.innerHTML='<p class="interest-placeholder">Geen recente tracks gevonden.</p>';return}const a=r.map(e=>{const l=e["@attr"]?.nowplaying==="true",c=e.image?.find(d=>d.size==="extralarge")?.["#text"]||e.image?.find(d=>d.size==="large")?.["#text"]||e.image?.find(d=>d.size==="medium")?.["#text"],t=e.artist?.["#text"]||e.artist,i=e.name,m=e.album?.["#text"];return`
        <a href="${e.url}" target="_blank" rel="noopener" class="feed-item${l?" now-playing":""}">
          ${c?`<img src="${c}" alt="${i}" class="feed-art feed-art-music" />`:'<div class="feed-art feed-art-music feed-art-empty"></div>'}
          <div class="feed-info">
            <span class="feed-title">${i}</span>
            <span class="feed-meta">${t}${m?` — ${m}`:""}</span>
          </div>
          ${l?'<span class="lastfm-live">Nu aan het luisteren</span>':""}
        </a>
      `}).join("");n.innerHTML=a}catch{n.innerHTML='<p class="interest-placeholder">Kon Last.fm niet laden.</p>'}}v();setInterval(v,3e4);const D="janusrvk",k="b1d6bd7b009c1dcc3e3561c6c0ef383a";async function A(n){try{return(await(await fetch(`https://api.themoviedb.org/3/movie/${n}/credits?api_key=${k}`)).json()).crew?.find(a=>a.job==="Director")?.name||""}catch{return""}}async function I(){const n=document.getElementById("letterboxd-content");try{const o=await(await fetch(`${u}${encodeURIComponent(`https://letterboxd.com/${D}/rss/`)}`)).text(),r=new DOMParser,a=r.parseFromString(o,"text/xml"),e=Array.from(a.querySelectorAll("item")).slice(0,5);if(e.length===0){n.innerHTML='<p class="interest-placeholder">Geen recente films gevonden.</p>';return}const c=(await Promise.all(e.map(async t=>{const i=t.querySelector("title")?.textContent||"",m=t.querySelector("link")?.textContent||"#",f=t.querySelector("description")?.textContent||"",C=r.parseFromString(f,"text/html").querySelector("img")?.getAttribute("src")||"",y=i.match(/★+½?/),_=y?y[0]:"",T=i.replace(/,\s*\d{4}\s*-\s*★+½?/,"").replace(/,\s*\d{4}/,"").trim(),w=i.match(/,\s*(\d{4})/),M=w?w[1]:"",x=t.getElementsByTagName("tmdb:movieId")[0]?.textContent||"",F=x?await A(x):"";return{cleanTitle:T,year:M,link:m,posterSrc:C,rating:_,director:F}}))).map(t=>`
      <a href="${t.link}" target="_blank" rel="noopener" class="feed-item">
        ${t.posterSrc?`<img src="${t.posterSrc}" alt="${t.cleanTitle}" class="feed-art" />`:'<div class="feed-art feed-art-empty"></div>'}
        <div class="feed-info">
          <span class="feed-title">${t.cleanTitle}${t.year?` (${t.year})`:""}</span>
          <span class="feed-meta">${t.director}${t.rating?(t.director?" — ":"")+t.rating:""}</span>
        </div>
      </a>
    `).join("");n.innerHTML=c}catch{n.innerHTML='<p class="interest-placeholder">Kon Letterboxd niet laden.</p>'}}I();const g="161530834";async function E(){const n=document.getElementById("goodreads-content");try{const o=await(await fetch(`${u}${encodeURIComponent(`https://www.goodreads.com/review/list_rss/${g}?shelf=currently-reading`)}`)).text(),r=new DOMParser,a=r.parseFromString(o,"text/xml"),e=Array.from(a.querySelectorAll("item")).slice(0,5);if(e.length===0){const c=await(await fetch(`${u}${encodeURIComponent(`https://www.goodreads.com/review/list_rss/${g}?shelf=read`)}`)).text(),t=r.parseFromString(c,"text/xml"),i=Array.from(t.querySelectorAll("item")).slice(0,5);if(i.length===0){n.innerHTML='<p class="interest-placeholder">Geen boeken gevonden.</p>';return}S(n,i,r,"Gelezen");return}S(n,e,r,"Aan het lezen")}catch{n.innerHTML='<p class="interest-placeholder">Kon Goodreads niet laden.</p>'}}function S(n,s,o,r){const a=s.map(e=>{const l=e.querySelector("title")?.textContent||"",c=e.querySelector("link")?.textContent||"#",t=e.querySelector("author_name")?.textContent||"",i=e.querySelector("description")?.textContent||"",p=(o.parseFromString(i,"text/html").querySelector("img")?.getAttribute("src")||"").replace(/\._\w+\d+_/,"._SX100_");return`
      <a href="${c}" target="_blank" rel="noopener" class="feed-item">
        ${p?`<img src="${p}" alt="${l}" class="feed-art feed-art-book" />`:'<div class="feed-art feed-art-empty"></div>'}
        <div class="feed-info">
          <span class="feed-title">${l}</span>
          <span class="feed-meta">${t}</span>
        </div>
      </a>
    `}).join("");n.innerHTML=a}E();function h(n){return new Intl.NumberFormat("nl-NL").format(n)}async function L(){const n=new Date(2026,1,14),s=new Date(new Date().getFullYear(),0,1),o=new Date,r=Math.floor(n.getTime()/1e3),e=await(await fetch(`https://ws.audioscrobbler.com/2.0/?method=user.getrecenttracks&user=${b}&api_key=${$}&format=json&from=${r}&limit=1`)).json(),l=parseInt(e.recenttracks?.["@attr"]?.total||"0",10),c=(o-n)/(1e3*60*60*24),t=(o-s)/(1e3*60*60*24);if(c<1)return l;const i=l/c;return Math.round(i*t)}async function q(){const s=await(await fetch(`${u}${encodeURIComponent(`https://letterboxd.com/${D}/rss/`)}`)).text(),o=new DOMParser().parseFromString(s,"text/xml"),r=new Date().getFullYear();return Array.from(o.querySelectorAll("item")).filter(e=>{const l=e.getElementsByTagName("letterboxd:watchedDate")[0]?.textContent,c=e.querySelector("pubDate")?.textContent,t=l||c||"";return new Date(t).getFullYear()===r}).length}const B=-1;async function O(){const s=await(await fetch(`${u}${encodeURIComponent(`https://www.goodreads.com/review/list_rss/${g}?shelf=read`)}`)).text(),o=new DOMParser().parseFromString(s,"text/xml"),r=new Date().getFullYear(),a=Array.from(o.querySelectorAll("item")).filter(e=>{const l=e.querySelector("user_read_at")?.textContent,c=e.querySelector("pubDate")?.textContent,t=l||c||"";return t&&new Date(t).getFullYear()===r});return Math.max(0,a.length+B)}async function R(){const[n,s,o]=await Promise.allSettled([L(),q(),O()]),r=document.getElementById("stat-scrobbles"),a=document.getElementById("stat-films"),e=document.getElementById("stat-books");r.textContent=n.status==="fulfilled"?h(n.value):"?",a.textContent=s.status==="fulfilled"?h(s.value):"?",e.textContent=o.status==="fulfilled"?h(o.value):"?"}document.getElementById("stat-scrobbles")&&R();
